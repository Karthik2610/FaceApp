-- DROP FUNCTIOn fnGetCalendarTimeDetails-- select * from fnGetCalendarTimeDetails ('05-25-2023','05-28-2023','05-25-2023','05-25-2023',17)CREATE Function fnGetCalendarTimeDetails(@FirstDate DATETIME,@LastDate DATETIME,@CalendarId Int) returns @tbl TABLE(Dates date,Day_Name nvarchar(50),Start_time time,End_time time)BEGINDECLARE @StartTime time;DECLARE @EndTime time;IF(DateName(dw,@FirstDate) = 'MONDAY')BEGIN SELECT @StartTime=MondayStartTime,@EndTime=MondayEndTime FROM CalendarSetting WHERE CalendarId=@CalendarId ENDELSE IF(DateName(dw,@FirstDate) = 'Tuesday')BEGIN SELECT @StartTime=TuesdayStartTime ,@EndTime=TuesdayEndTime FROM CalendarSetting WHERE CalendarId=@CalendarId ENDELSE IF(DateName(dw,@FirstDate) = 'Wednesday')BEGIN SELECT @StartTime=WednesdayStartTime,@EndTime=WednesdayEndTime  FROM CalendarSetting WHERE CalendarId=@CalendarId ENDELSE IF(DateName(dw,@FirstDate) = 'Thursday')BEGIN SELECT @StartTime=ThursdayStartTime,@EndTime=ThursdayEndTime FROM CalendarSetting WHERE CalendarId=@CalendarId ENDELSE IF(DateName(dw,@FirstDate) = 'Friday')BEGIN SELECT @StartTime=FridayStartTime,@EndTime=FridayEndTime  FROM CalendarSetting WHERE CalendarId=@CalendarId ENDELSE IF(DateName(dw,@FirstDate) = 'Saturday')BEGIN SELECT @StartTime=SaturdayStartTime,@EndTime=SaturdayEndTime  FROM CalendarSetting WHERE CalendarId=@CalendarId ENDELSE IF(DateName(dw,@FirstDate) = 'Sunday')BEGIN SELECT @StartTime=SundayStartTime,@EndTime=SundayEndTime  FROM CalendarSetting WHERE CalendarId=@CalendarId ENDINSERT @tbl VALUES( @FirstDate,DateName(dw,@FirstDate),@StartTime,@EndTime)WHILE @FirstDate < @LastDateBEGINSET @FirstDate = DATEADD( day,1, @FirstDate)IF(DateName(dw,@FirstDate) = 'MONDAY')BEGIN SELECT @StartTime=MondayStartTime,@EndTime=MondayEndTime FROM CalendarSetting WHERE CalendarId=@CalendarId ENDELSE IF(DateName(dw,@FirstDate) = 'Tuesday')BEGIN SELECT @StartTime=TuesdayStartTime ,@EndTime=TuesdayEndTime FROM CalendarSetting WHERE CalendarId=@CalendarId ENDELSE IF(DateName(dw,@FirstDate) = 'Wednesday')BEGIN SELECT @StartTime=WednesdayStartTime,@EndTime=WednesdayEndTime  FROM CalendarSetting WHERE CalendarId=@CalendarId ENDELSE IF(DateName(dw,@FirstDate) = 'Thursday')BEGIN SELECT @StartTime=ThursdayStartTime,@EndTime=ThursdayEndTime FROM CalendarSetting WHERE CalendarId=@CalendarId ENDELSE IF(DateName(dw,@FirstDate) = 'Friday')BEGIN SELECT @StartTime=FridayStartTime,@EndTime=FridayEndTime  FROM CalendarSetting WHERE CalendarId=@CalendarId ENDELSE IF(DateName(dw,@FirstDate) = 'Saturday')BEGIN SELECT @StartTime=SaturdayStartTime,@EndTime=SaturdayEndTime  FROM CalendarSetting WHERE CalendarId=@CalendarId ENDELSE IF(DateName(dw,@FirstDate) = 'Sunday')BEGIN SELECT @StartTime=SundayStartTime,@EndTime=SundayEndTime  FROM CalendarSetting WHERE CalendarId=@CalendarId ENDINSERT @tbl VALUES( @FirstDate,DateName(dw,@FirstDate),@StartTime,@EndTime)ENDreturnEND